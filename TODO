=== TODO ===

BUGS:
- [BUG] enabling virtual devices breaks the hub
- [BUG] client/hub registration?

Settings:
! HASS settings (enable disable discovery + topic root)
! seperate root topics (homie, HASS, system state, custom, etc.)
! Make class constants configurable
! Split hiding of controls & applying default (protocol) settings
! settings default vs disabled controls
! settings restore app defaults button
! Check 'App' initilaized (prevent settings crash)
! Update Instructions
- optional normalization for custom protocol
- system info topic configurable
- Enable/disable all devices
- display broadcast progress (loader)
- Birth & Last will topics + messages
- enable/disable set command handler
- Disable device capabilities
- Show number of messages per device
- Display number of messages in queue (fill 100% === number of devices)

HASS:
! Enable/disable (broadcast / clear messages)
! Color temperature (read & write)
! Update correct HSV values when setting one of the values (color topic)
- Set numeric values? input_number: https://www.home-assistant.io/components/input_number/?
- Remaining device types (Alarm control panels, Binary sensors, Cameras, Covers, Fans, HVACs, Lights, Locks, Sensors, Switches, Vacuums)
- thermostat modes
- configure additional properties for the remaining capabilities (e.g. icon, device class, etc.)
- [REFACTOR] De-couple parse & format logic. Refactor data processing. Create handlers per type?

Homie:
! color values: round float values (int)
! Scale 0...100 round float values (int)
- Introduce queue for updating device state (use brightness slider ha app)
- Check client availability processing
- Publish device/$state disconnect message?
- Device Aliasses (e.g. dim/brightness, light temperature, etc.)

App:
- [Check] shutdown procedure
- [Check] Refresh devices on device/zone changes + Broadcast
- Uninstall app => unsubscribe from topics on MQTT lient

Homey:
- Flow card for MQTT Device (i.e. to add scenes)
- profiling/optimzations

Discovery (auto discover external devices):
- Implement Homie discovery
- Implement HASS Discovery
- Create virtual devices from MQTT discovery

Commands:
- Updating state for multiple devices (e.g. all devices in a room)
- Info requests:
  * System
  * Device classes
  * Zones
  * ...
- Trigger flow
- Listen to scene flow triggers

System info:
- Publish system info on seperate topics (i.s.o. json)



======= DONE =======
- Normalize device name
- Fix getDeviceName for homey 1.5.13
- MQTT discovery (see OpenHAB / Domiticz)
- Implement Homie convention (Homey v1.5.13)
- Homie Convention for Homey v2.0
- Normalization BUG
- Handle device & zone name changes in HomieDispatcher
- Try to combine the old topic format with the Homie Convention (&Ditch the old topic format?)
- Fix on/off button
- Disable settings running button (show loader) untill state active state is received
- Settings page
	* Select communication protocol (Homie | Homey)
	* Homie color format (HSV | RGB)
	* Configure root topic
	* Configure Homie topic
	* Enable/disable system state dispatcher
	* Enable/Disable triggers & commands
	* Include/Exclude devices & capabilities for dispatchers
	* refresh/resend state
	* Inject device id
	* Update settings on save
	* Display current status
	* Log stream
- Rename to 'MQTT Hub'
- Fix app icon
- App images
- BUG: Initial settings (root topic undefined)
- BUG: Normalize injected device class & zone
- Custom protocal & disable non-protocol options
- Activate & update command + rename to 'set'
- Settings Instructions tab
- Register & cleanup device topics when disabling devices
- fix non-awaited promises
- Catch Renaming zones / devices
- Check: dispatched firmWare version
x test internal MQTT client ('socket hang up' fix? duplicate mem usage, config & maintenance...)
- [fixed] some $set commands don't work (false|null|undefie|'' messages)
- [fixed] all devices are shown off @ first load (dispatch state @ registering devices)
- HASS Discovery setup
- HASS Devices
- HASS icons
- HASS Enum & string values
- broadcast on hass birth
- put HASS discovery before Homie
- birth & last will messages
- CHECK: MQTT Client handling 0 values
- implement scalable property 0-1 (float) | 0-100 (int)
- HASS Broadcast
- HASS disable devices
- HASS enable device => send discover config
- HASS Keep track of device topics & remove messages from queue when disabling device
- Send empty messages to clear devices
